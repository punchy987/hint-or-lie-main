<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hint or Lie ¬∑ by Mits</title>

    <link rel="prefetch" href="/images/background-hero.svg?v=1" as="image" type="image/svg+xml">
    <script defer src="/socket.io/socket.io.js"></script>

    <link rel="manifest" href="/manifest.json">
    
    <!-- Configuration du serveur pour mobile -->
    <!-- R√àGLE D'OR : Cache busting pour forcer le rechargement apr√®s modification -->
    <script src="/js/config/server-config.js?v=2"></script>
    
    <link rel="stylesheet" href="/css/hud.css">

    <!-- Identit√© visuelle & PWA -->
    <meta name="theme-color" content="#2F3542">
    <link rel="icon" type="image/svg+xml" href="/assets/icon-hol.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192.png">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
</head>
<body class="hud-root" data-screen="screen-home">

    <!-- Global Transition Overlay (anti-FOPC) -->
    <div id="global-transition-overlay">
        <div class="logo-loader">
            <span class="logo-letter logo-h">H</span><span class="logo-letter logo-l">L</span>
        </div>
    </div>

    <!-- Overlays Cin√©matiques (Transitions de phase) -->
    <div id="role-reveal-overlay" class="cinematic-overlay" style="display:none">
        <div style="display: flex; flex-direction: column; align-items: center; gap: 1rem;">
            <span class="role-intro-text" style="color: #FFFFFF; font-family: 'Lexend', sans-serif; font-size: 1.4rem; opacity: 0.8; text-align: center; text-transform: uppercase; letter-spacing: -0.02em;">Vous √™tes...</span>
            <div id="reveal-role-text"></div>
        </div>
    </div>
    <div id="result-reveal-overlay" class="cinematic-overlay" style="display:none">
        <div id="victory-banner" class="hidden">VICTOIRE</div>
        <div id="defeat-banner" class="hidden">D√âFAITE</div>
    </div>

    <!-- Modal Spectateur (Attente de manche) -->
    <div id="spectator-waiting" class="modal-overlay" style="display:none">
        <div class="panel">
            <h2>Mode Spectateur</h2>
            <p id="spectator-phase">Attente du serveur...</p>
            <button id="btn-leave-spectator" class="btn btn-secondary">Quitter la salle</button>
        </div>
    </div>

    <main id="game-container">

        <!-- √âcran d'accueil -->
        <section id="screen-home" class="screen">
            <div class="panel home-panel">
                <!-- Header avec logo et titre -->
                <div class="home-header">
                    <div class="logo-square">
                        <span class="logo-letter logo-h">H</span><span class="logo-letter logo-l">L</span>
                    </div>
                    <div class="title-group">
                        <h1 class="game-title"><span class="text-crew">Hint</span> <span class="text-impostor">or</span> <span class="text-impostor">Lie</span></h1>
                        <p class="subtitle">by Mits</p>
                        <p class="tagline">Chaque indice compte...</p>
                    </div>
                </div>

                <!-- Bloc Concept du Jeu (Onboarding) -->
                <div class="home-concept-box">
                    <h3 class="concept-title">LE CONCEPT</h3>
                    <ul class="concept-list">
                        <li><strong>üéØ OBJECTIF</strong> : Un imposteur se cache parmi vous. Trouvez-le.</li>
                        <li><strong>‚úçÔ∏è INDICES</strong> : Donnez un mot-cl√© subtil pour prouver votre identit√©.</li>
                        <li><strong>üó≥Ô∏è VOTE</strong> : Inspectez les cartes et √©liminez le menteur.</li>
                    </ul>
                </div>

                <!-- Avatar Central Hero -->
                <div id="hero-avatar-container">
                    <div class="hero-avatar-wrapper">
                        <img id="hero-avatar-img" src="https://api.dicebear.com/7.x/bottts/svg?seed=HintOrLie&backgroundColor=b6e3f4,c0aede,d1d4f9" alt="Avatar Robot">
                    </div>
                </div>

                <!-- Syst√®me d'onglets int√©gr√©s -->
                <div class="tabs-integrated">
                    <button id="tab-join" role="tab" aria-selected="true" class="tab-btn">Rejoindre</button>
                    <button id="tab-create" role="tab" aria-selected="false" class="tab-btn">Cr√©er</button>
                </div>

                <!-- Pane Rejoindre -->
                <div id="pane-join" class="tab-pane active">
                    <div class="form-compact">
                        <input type="text" id="name-join" class="input" placeholder="Entrez votre pseudo" maxlength="16">
                        <input type="text" id="join-code" class="input" placeholder="Code (4 chiffres)" inputmode="numeric" maxlength="4">
                    </div>
                    <button id="btn-join" class="btn btn-action btn-cyan">Rejoindre</button>
                </div>

                <!-- Pane Cr√©er -->
                <div id="pane-create" class="tab-pane">
                    <div class="form-compact">
                        <input type="text" id="name-create" class="input" placeholder="Entrez votre pseudo" maxlength="16">
                    </div>
                    <button id="btn-create" class="btn btn-action btn-violet">Cr√©er</button>
                </div>

                <!-- Liste des Salons Publics -->
                <div id="public-rooms-container" class="panel">
                    <h3>Salons Publics</h3>
                    <ul id="public-rooms-list"></ul>
                </div>

                <!-- Footer du Panel -->
                <div class="home-footer">
                    <div class="leaderboard-preview">
                        <h4>Classement ‚Äî Top 10</h4>
                        <button id="btn-refresh-leaderboard" class="btn btn-secondary btn-small">Actualiser</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- √âcran Lobby/Salle d'attente -->
        <section id="screen-lobby" class="screen" style="display: none;">
            <header class="lobby-header">
                <div class="logo-square">
                    <span class="logo-letter logo-h">H</span><span class="logo-letter logo-l">L</span>
                </div>
                <div class="lobby-code-container">
                    <span>CODE</span>
                    <strong id="lobby-code">1234</strong>
                </div>
                <button id="btn-back-home" class="btn btn-secondary">QUITTER</button>
            </header>
            
            <div id="lobby-ready-pill">0/0 pr√™ts</div>
            <h2>Joueurs connect√©s</h2>
            <div id="players" class="player-grid"></div>

            <div class="lobby-actions">
                <button id="btn-ready" class="btn btn-primary">Je suis pr√™t</button>
                <button id="btn-toggle-privacy" class="btn btn-secondary" style="display: none;">üîí PRIV√â</button>
                <button id="btn-show-rules-lobby" class="label-secondary btn-link-secondary">LIRE LES R√àGLES</button>
                <div id="timer-lobby" style="display: none;"></div>
            </div>
        </section>

        <!-- √âcran Phase Indices -->
        <section id="screen-hint" class="screen" style="display: none;">
            <div class="phase-bar"><div class="phase-progress"><div class="bar"></div></div></div>
            <div class="panel">
                <header class="screen-header">
                    <button class="btn-quit-to-lobby" id="btn-lobby-hint">üè†</button>
                    <span class="round-tag">Round <span id="round-num" class="round-live">1</span></span>
                    <div class="theme-container">
                        <span class="label-secondary">Th√®me de la manche</span>
                        <h2 id="theme-hint-name" class="theme-title">Th√®me</h2>
                    </div>
                    <div id="timer-hints" class="pill">00:00</div>
                </header>
                
                <div id="my-role-container">R√¥le : <span id="my-role">...</span></div>
                <div id="crew-word-chip" class="word-card">
                    <span>Ton mot secret</span>
                    <strong id="crew-word">...</strong>
                </div>
                <div id="impostor-tip" class="tip" style="display: none;"></div>

                <div class="input-group">
                    <input type="text" id="hint-input" placeholder="Ton indice (1 mot)..." maxlength="20">
                    <button id="btn-send-hint" class="btn btn-primary">Envoyer</button>
                </div>
                <div id="hint-status" class="status-msg"></div>
                <div id="progress-hints" class="progress-text">0/0</div>
            </div>
        </section>

        <!-- √âcran Phase Vote -->
        <section id="screen-vote" class="screen" style="display: none;">
            <div class="phase-bar"><div class="phase-progress"><div class="bar"></div></div></div>
            <div class="panel">
                <header class="screen-header">
                    <button class="btn-quit-to-lobby" id="btn-lobby-vote">üè†</button>
                    <div class="theme-container">
                        <span class="label-secondary">Th√®me de la manche</span>
                        <h2 id="theme-vote-name" class="theme-title">Vote</h2>
                    </div>
                    <div class="header-pills">
                        <div id="timer-vote" class="pill">00:00</div>
                        <div id="progress-vote" class="pill">0/0</div>
                    </div>
                </header>
                <h2 class="instruction">Qui ment ?</h2>
                <p class="vote-instruction">Touche une carte pour l'inspecter</p>
                <div class="vote-preview-slot" id="vote-preview-slot"></div>
                <div id="hints" class="vote-grid"></div>
                <button id="btn-confirm-vote">Confirmer mon vote</button>
            </div>
        </section>

        <!-- √âcran R√©sultats de manche -->
        <section id="screen-result" class="screen" style="display: none;">
            <div class="phase-bar"><div class="phase-progress"><div class="bar"></div></div></div>
            <div class="panel">
                <header class="screen-header">
                    <button class="btn-quit-to-lobby" id="btn-lobby-result">üè†</button>
                    <h2 class="theme-title">R√©sultat</h2>
                    <div id="timer-reveal" class="pill">00:00</div>
                </header>
                <div class="result-box">
                    <div class="result-item">Le mot √©tait : <strong id="res-common">...</strong></div>
                    <div class="label-revelation">L'IMPOSTEUR √âTAIT :</div>
                    <div id="res-imp-name" class="impostor-reveal"></div>
                </div>
                <div id="res-votes" class="votes-detail"></div>
                <button id="btn-next" class="btn btn-primary">Manche suivante</button>
            </div>
        </section>

        <!-- Syst√®me de Toast -->
        <div id="toast"></div>

        <!-- Scoreboard (Inject√© dynamiquement par helpers.js) -->
        <!-- R√àGLE D'OR : Masqu√© par d√©faut sur la page d'accueil -->
        <div id="scoreboard" class="panel scoreboard-panel is-hidden" style="display: none;">
            <h3 class="label-secondary">Tableau de Score</h3>
            <ul id="score-list"></ul>
        </div>

        <!-- Modale de Fin de Partie / GameOver -->
        <div id="modal" class="modal-overlay" style="display: none;">
            <div class="box panel">
                <button id="btn-modal-lobby" style="display:none"></button>
            </div>
        </div>

    </main>

    <!-- Syst√®me Arcade Bubbles : R√©actions Lat√©rales -->
    <!-- R√àGLE D'OR : Masqu√© par d√©faut sur la page d'accueil -->
    <div id="reaction-triggers" style="display: none;">
        <div class="reaction-handle" title="R√©actions"></div>
        <button class="btn-reaction" data-emoji="üòÇ" title="Rire">üòÇ</button>
        <button class="btn-reaction" data-emoji="ü§î" title="R√©fl√©chir">ü§î</button>
        <button class="btn-reaction" data-emoji="ü§®" title="Doute">ü§®</button>
        <button class="btn-reaction" data-emoji="üî•" title="Feu">üî•</button>
        <button class="btn-reaction" data-emoji="üíÄ" title="Mort">üíÄ</button>
        <button class="btn-reaction" data-emoji="üò≠" title="Pleurer">üò≠</button>
        <button class="btn-reaction" data-emoji="üò°" title="Col√®re">üò°</button>
    </div>
    <div id="reaction-display-area" style="display: none;"></div>

    <!-- Modal R√®gles du jeu (Lobby) -->
    <div id="modal-rules-lobby" class="modal-overlay" style="display:none;">
        <div class="panel rules-panel">
            <div class="home-concept-box">
                <h3 class="concept-title">LE CONCEPT</h3>
                <ul class="concept-list">
                    <li><strong>üéØ OBJECTIF</strong> : Un imposteur se cache parmi vous. Trouvez-le.</li>
                    <li><strong>‚úçÔ∏è INDICES</strong> : Donnez un mot-cl√© subtil pour prouver votre identit√©.</li>
                    <li><strong>üó≥Ô∏è VOTE</strong> : Inspectez les cartes et √©liminez le menteur.</li>
                </ul>
            </div>
            <button id="btn-close-rules-lobby" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">FERMER</button>
        </div>
    </div>    
    <!-- Banni√®re de mise √† jour PWA -->
    <div id="update-banner" style="display:none;"></div>

    <script defer src="/js/core/dom.js"></script>
    <script defer src="/js/core/helpers.js"></script>
    <script defer src="/js/core/state.js"></script>
    <script defer src="/js/core/socket.js"></script>
  
    <script defer src="/js/features/leaderboard.js"></script>
    <script defer src="/js/features/home.js"></script>
    <script defer src="/js/features/hints.js"></script>
    <script defer src="/js/features/vote.js"></script>
    <script defer src="/js/features/results.js"></script>
    
    <script defer src="/js/pwa/update.js"></script>
    <script defer src="/js/dev/guard.js"></script>
    
    <script defer src="/js/main.js"></script>

</body>
</html>
