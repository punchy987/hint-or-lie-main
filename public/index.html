<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hint or Lie · by Mits</title>

    <link rel="prefetch" href="/images/background-hero.svg?v=1" as="image" type="image/svg+xml">
    <script defer src="/socket.io/socket.io.js"></script>

    <link rel="manifest" href="/manifest.json">
    
    <link rel="stylesheet" href="/css/hud.css">
    <link rel="stylesheet" href="/css/99-pwa-update.css">
    <link rel="stylesheet" href="/css/98-responsive.css">

    <meta name="theme-color" content="#0a0e14">
    <link rel="icon" type="image/png" href="/icons/icon-32.png">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
</head>
<body class="hud-root">

    <!-- Overlays Cinématiques (Transitions de phase) -->
    <div id="role-reveal-overlay" class="cinematic-overlay" style="display:none">
        <div id="reveal-role-text"></div>
    </div>
    <div id="result-reveal-overlay" class="cinematic-overlay" style="display:none">
        <div id="reveal-result-text"></div>
    </div>

    <!-- Modal Spectateur (Attente de manche) -->
    <div id="spectator-waiting" class="modal-overlay" style="display:none">
        <div class="panel">
            <h2>Mode Spectateur</h2>
            <p id="spectator-phase">Attente du serveur...</p>
            <button id="btn-leave-spectator" class="btn btn-secondary">Quitter la salle</button>
        </div>
    </div>

    <main id="game-container">

        <!-- Écran d'accueil -->
        <section id="screen-home" class="screen">
            <div class="panel">
                <h1 class="game-title">Hint <span>or</span> Lie</h1>
                <div class="tabs">
                    <button id="tab-create" role="tab" aria-selected="true">Créer une salle</button>
                    <button id="tab-join" role="tab" aria-selected="false">Rejoindre</button>
                </div>

                <div id="pane-create" class="tab-pane active">
                    <div class="avatar-picker">
                        <img id="avatar-preview-img-create" src="https://api.dicebear.com/7.x/bottts/svg?seed=Joueur&backgroundColor=b6e3f4,c0aede,d1d4f9" alt="Avatar Preview">
                    </div>
                    <input type="text" id="name-create" placeholder="Entrez votre pseudo" maxlength="16">
                    <button id="btn-create" class="btn btn-primary">Créer</button>
                </div>

                <div id="pane-join" class="tab-pane">
                    <div class="avatar-picker">
                        <img id="avatar-preview-img-join" src="https://api.dicebear.com/7.x/bottts/svg?seed=Joueur&backgroundColor=b6e3f4,c0aede,d1d4f9" alt="Avatar Preview">
                    </div>
                    <input type="text" id="name-join" placeholder="Entrez votre pseudo" maxlength="16">
                    <input type="text" id="join-code" placeholder="Code (4 chiffres)" inputmode="numeric" maxlength="4">
                    <button id="btn-join" class="btn btn-primary">Rejoindre</button>
                </div>

                 <div class="rules-container">
                    <button id="btn-how" class="btn btn-secondary">Règles rapides</button>
                    <div id="how" style="display: none;">
                        <p><strong>But du jeu :</strong> L'imposteur doit se fondre parmi les équipiers.</p>
                        <ul>
                            <li><strong>Équipiers :</strong> Vous recevez un mot secret. Donnez un indice (un seul mot) pour le faire deviner aux autres.</li>
                            <li><strong>Imposteur :</strong> Vous n'avez pas le mot. Soyez malin, écoutez les indices des autres et bluffez !</li>
                            <li><strong>Vote :</strong> Tout le monde vote pour démasquer l'imposteur.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Écran Lobby/Salle d'attente -->
        <section id="screen-lobby" class="screen" style="display: none;">
            <header class="lobby-header">
                <button id="btn-back-home" class="btn btn-secondary">&lt; Quitter</button>
                <div class="lobby-code-container">
                    <span>CODE</span>
                    <strong id="lobby-code">1234</strong>
                </div>
                <div id="lobby-ready-pill">0/0 prêts</div>
            </header>
            
            <h2>Joueurs connectés</h2>
            <div id="players" class="player-grid"></div>

            <div class="lobby-actions">
                <button id="btn-ready" class="btn btn-primary">Je suis prêt</button>
                <div id="timer-lobby" style="display: none;"></div>
            </div>
        </section>

        <!-- Écran Phase Indices -->
        <section id="screen-hint" class="screen" style="display: none;">
            <div class="phase-bar"><div class="phase-progress"><div class="bar"></div></div></div>
            <div class="panel">
                <header class="screen-header">
                    <span class="round-tag">Round <span id="round-num" class="round-live">1</span></span>
                    <h2 id="theme-hint-name" class="theme-title">Thème</h2>
                    <div id="timer-hints" class="pill">00:00</div>
                </header>
                
                <div id="my-role-container">Rôle : <span id="my-role">...</span></div>
                <div id="crew-word-chip" class="word-card">
                    <span>Ton mot secret</span>
                    <strong id="crew-word">...</strong>
                </div>
                <div id="impostor-tip" class="tip" style="display: none;"></div>

                <div class="input-group">
                    <input type="text" id="hint-input" placeholder="Ton indice (1 mot)..." maxlength="20">
                    <button id="btn-send-hint" class="btn btn-primary">Envoyer</button>
                </div>
                <div id="hint-status" class="status-msg"></div>
                <div id="progress-hints" class="progress-text">0/0</div>
            </div>
        </section>

        <!-- Écran Phase Vote -->
        <section id="screen-vote" class="screen" style="display: none;">
            <div class="phase-bar"><div class="phase-progress"><div class="bar"></div></div></div>
            <div class="panel">
                <header class="screen-header">
                    <h2 id="theme-vote-name" class="theme-title">Vote</h2>
                    <div class="header-pills">
                        <div id="timer-vote" class="pill">00:00</div>
                        <div id="progress-vote" class="pill">0/0</div>
                    </div>
                </header>
                <p class="instruction">Qui est l'imposteur ?</p>
                <div id="hints" class="vote-grid"></div>
            </div>
        </section>

        <!-- Écran Résultats de manche -->
        <section id="screen-result" class="screen" style="display: none;">
            <div class="phase-bar"><div class="phase-progress"><div class="bar"></div></div></div>
            <div class="panel">
                <header class="screen-header">
                    <h2 class="theme-title">Résultat</h2>
                    <div id="timer-reveal" class="pill">00:00</div>
                </header>
                <div class="result-box">
                    <div class="result-item">Le mot était : <strong id="res-common">...</strong></div>
                    <div id="res-imp-name" class="impostor-reveal"></div>
                </div>
                <div id="res-votes" class="votes-detail"></div>
                <button id="btn-next" class="btn btn-primary">Manche suivante</button>
            </div>
        </section>

        <!-- Système de Toast -->
        <div id="toast"></div>

        <!-- Scoreboard (Injecté dynamiquement par helpers.js) -->
        <div id="scoreboard" class="panel scoreboard-panel" style="display: none;">
            <h3>Classement</h3>
            <ul id="score-list"></ul>
        </div>

        <!-- Modale de Fin de Partie / GameOver -->
        <div id="modal" class="modal-overlay" style="display: none;">
            <div class="box panel">
                <button id="btn-modal-lobby" style="display:none"></button>
            </div>
        </div>

    </main>
    
    <!-- Bannière de mise à jour PWA -->
    <div id="update-banner" style="display:none;"></div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script defer src="/js/core/dom.js"></script>
    <script defer src="/js/core/helpers.js"></script>
    <script defer src="/js/core/state.js"></script>
    <script defer src="/js/core/socket.js"></script>
  
    <script defer src="/js/features/leaderboard.js"></script>
    <script defer src="/js/features/home.js"></script>
    <script defer src="/js/features/hints.js"></script>
    <script defer src="/js/features/vote.js"></script>
    <script defer src="/js/features/results.js"></script>
    
    <script defer src="/js/pwa/update.js"></script>
    <script defer src="/js/dev/guard.js"></script>
    
    <script defer src="/js/main.js"></script>

</body>
</html>
